{% load static %}
<style>
  /* Light Theme Variables */
  :root {
    --bg-color: #ffffff;
    --card-bg: #f8f9fa;
    --card-hover: #e9ecef;
    --text-primary: #2d3436;
    --text-secondary: #6c757d;
    --border-color:#e6a50d1a;
    --heart-color: #e63946;
    --rank-1: #ffd700;
    --rank-2: #c0c0c0;
    --rank-3: #cd7f32;
    --shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  }



  .leaderboard-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .leaderboard-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-radius: 12px;
    background: var(--bg-color);
    transition: all 0.2s ease;
    box-shadow: var(--shadow);
    border: 1px solid var(--border-color);
    position: relative;
  }

  .leaderboard-item:active {
    transform: scale(0.98);
    background: var(--card-hover);
  }

  .rank {
    font-weight: 800;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    font-size: 0.9rem;
    color: var(--text-secondary);
    background: #f1f3f5;
    border-radius: 6px;
    position: absolute;
    top: 4px;
    left: 4px;
  }

  .rank-1 { 
    background: var(--rank-1);
    color: #000;
    font-weight: 900;
  }
  .rank-2 { 
    background: var(--rank-2);
    color: #000;
    font-weight: 900;
  }
  .rank-3 { 
    background: var(--rank-3);
    color: #fff;
    font-weight: 900;
  }

  /* Trophy icon for top 3 */
  .rank-1-trophy-icon {
    color:rgb(255, 136, 0);
  }

  .rank-2-trophy-icon {
    color:rgb(52, 51, 51);
  }

  .rank-3-trophy-icon {
    color:#636e72;
  }


  .pitch-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    margin-right: 12px;
    object-fit: cover;
    background: #fff;
    padding: 2px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border: 1px solid var(--border-color);
  }

  .pitch-details {
    flex: 1;
    min-width: 0;
    padding-right: 8px;
  }

  .pitch-name {
    font-weight: 600;
    font-size: 0.95rem;
    margin: 0 0 2px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .pitch-info {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 2px;
  }

  .pitch-category {
    font-size: 0.7rem;
    color: var(--text-secondary);
    background: #f0f0f0;
    padding: 2px 6px;
    border-radius: 4px;
    white-space: nowrap;
    font-weight: 500;
  }

  .pitch-mentions {
    font-size: 0.7rem;
    color: #666;
    display: flex;
    align-items: center;
    gap: 2px;
  }

  .pitch-description {
    font-size: 0.75rem;
    color: #555;
    margin-top: 4px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
  }

  .engagement {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 40px;
  }

  .engagement i {
    margin-bottom: 2px;
  }

  .engagement-count {
    font-size: 0.75rem;
    color: var(--text-secondary);
    font-weight: 600;
  }

  .verified-badge {
    color: #1DA1F2 !important;
    font-size: 0.8em !important;
    margin-left: 2px;
  }
</style>

<div class="mobile-leaderboard">
    <div class="section-header">
        <h2 class="section-title">
            <i class="fa-solid fa-trophy"></i>
            Top Pitches
        </h2>
        <a href="{% url 'leaderboard' %}" class="section-link">
            Expand
            <i class="fa-solid fa-expand"></i>
        </a>
    </div>
      <ul class="leaderboard-list">
    {% for pitch in top_pitches|slice:":10" %} 
    <div>   
        <li class="leaderboard-item rank-{{ forloop.counter }}">
            <div class="rank rank-{{ forloop.counter }}">{{ forloop.counter }}</div>
            <a href="{% url 'detail' slug=pitch.slug %}" style="text-decoration: none; color: inherit;">
                <img src="{{ pitch.icon_url }}" 
                    alt="{{ pitch.name }}" 
                    class="pitch-icon"
                    onerror="this.onerror=null; this.src='{% static 'icon.png' %}';">
            </a>
            <div class="pitch-details">
                <a href="{% url 'detail' slug=pitch.slug %}" style="text-decoration: none; color: inherit;">
                    <div class="pitch-name">
                        {{ pitch.name|truncatechars:20 }}
                        {% if pitch.pitch_data.0.user.verified %}
                        <i class="fa-solid fa-circle-check verified-badge"></i>
                        {% endif %}</div>
                    <div class="pitch-info">
                        <span class="pitch-category">
                            {% if pitch.category %}{{ pitch.category }}{% else %}Software{% endif %}
                        </span>
                        {% if pitch.mention_count %}
                        <span class="pitch-mentions">
                            <i class="fa-solid fa-bullhorn has-text-warning"></i> {{ pitch.mention_count }}
                        </span>
                        {% endif %}
                    </div>
                    {% if pitch.description %}
                    <div class="pitch-description">
                        {{ pitch.description|truncatechars:60 }}
                    </div>
                    {% endif %}           
                </a>
            </div> 
            <div class="engagement">                
                <span class="engagement-count">
                  {% if forloop.counter == 1 %}
                  <i class="fa-solid fa-trophy fa-2x rank-1-trophy-icon"></i>
                  {% elif forloop.counter == 2 %}
                  <i class="fa-solid fa-medal fa-2x rank-2-trophy-icon"></i>
                  {% elif forloop.counter == 3 %}
                  <i class="fa-solid fa-award fa-2x rank-3-trophy-icon"></i>
                  {% else %}
                  <i class="fa-solid fa-gem" style="color: #E0115F !important;"></i>
                  {% endif %} {{ pitch.rank|default:0 }}                
                </span>
                <span class="engagement-count">
                    <button class="button is-small is-text clap-button" data-slug="{{ pitch.slug }}">
                        <span class="icon">
                            <i class="fa-solid fa-hands-clapping has-text-success"></i>
                        </span>
                        <span class="clap-count">{{ pitch.clap|default:0 }}</span>
                    </button>
                </span>
                <span onclick="window.open('{{ pitch.url }}', '_blank');" class="is-clickable"><i class="fa-solid fa-external-link-alt has-text-link"></i></span>
                
            </div>
        </li>
    </div>
    {% endfor %}
    </ul>
    <div class="view-all-container " style="margin: 20px 0; text-align: center;">
        <a href="{% url 'leaderboard' %}" class="button is-warning is-rounded " style="padding: 0.75em 1.5em; font-weight: 500; transition: all 0.3s ease;">
            <span>View Topping Pitches</span>
            <span class="icon is-small">
                <i class="fa-solid fa-arrow-right" style="transition: transform 0.3s ease;"></i>
            </span>
        </a>
    </div>
</div>

<style>
  .view-all-container .button {
      border: 1px solid #e0e0e0;
      background: #f8f9fa;
      color: #333;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }

  .view-all-container .button:hover {
      background: #f0f0f0;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .view-all-container .button:hover .fa-arrow-right {
      transform: translateX(3px);
  }

  .view-all-container .button:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
</style>